[{"id":"323acb7bb21b7c66607f842352069cd1","title":"Generalised Linear Models","content":"指数族分布与泊松回归Exponential Family of Distributions (指数族分布)考虑一个随机变量 , 其概率密度函数 (p.d.f.) 或概率质量函数 (p.m.f.) 依赖于参数 . 该分布属于指数族 (exponential family),如果该分布可以写成其中  项被称为自然参数 (natural parameter). 如果, 那么这个分布也被称为规范形式 (canonical form).\n\n\n\n\n\n\nExample\n证明分布是指数族的成员之一, 且为规范形式.\n\n\n\n\n\n\n\n\nProof\n由于, 则它的p.m.f.为那么 识别参数:因此分布是指数族的成员之一,用Thm.中的结果计算数学期望得 \n\n\n\n\n\n\n\n\n\n\nTheoremThe random variable  follows an exponential family distribution of the form , can be expressed as\n\n\n\n\n\n\n\nProof\nFirst note that since  is a p.d.f.For the derivative,Integrating with respect to  then gives\nAlso, taking the second derivative gives \nIntegrating with respect to  then gives\n\n\n\n\n\n\n\n\n\n\n\nDefinitionThe derivative of the log-likelihood  with respect to the parameter , i.e.\n对于指数族分布来说, 其得分为因此注意在求导的时候使用链式法则, 即若 , 则 .\n\n\n\n\n\n\n\n\n\nDefinitionThe Fisher’s information, denoted as , is given by\nFor members of the exponential family of distributions, sincewe have that\nGeneralised Linear Models广义线性模型 (Generalized Linear Model, GLM) 是线性回归的推广, 用于建模非正态分布的响应变量. 相比于传统的线性回归, GLM允许响应变量服从指数族分布, 并通过链接函数 (link function) 建立预测变量和响应变量之间的关系.\n\n\n\n\n\n\n\n\n\nDefinitionLet  be independent responses from an exponential family distribution in canonical form () and  for .A generalised linear model (GLM) is a model of the form , where  is a -dimensional parameter vector,  is the th row of thedesign matrix , and  is a monotonic (单调), differentiable function called the link function, a.k.a. canonical link.\nMaximum Likelihood Estimation of GLM Coefficients我们此前提到 score, , 很显然,  的根就是 , 即参数的最大似然估计.\n当方程  不易求解时, 那么有两种拟合参数的迭代办法:\n\nNewton-Raphson 方法:\n\n\n\nFisher scoring: 用  的数学期望 , 即 Fisher’s information, 代替 , 从而提高稳定性:\n\n\nDevianceDefinitionThe deviance, , is defined as\n\n\n\nwhere  is the maximised log-likelihood for the saturated model (饱和模型) and  is the maximised log-likelihood for the model of interest.\n\n\nThe likelihood ratio provides a measure of how well the model of interest fits compared with the full model. 也就是说,  就是本身的似然函数, 而 full model 是把参数替换为 .\nIn practice we often use the logarithm of the likelihood ratio: \n\n\n\n\nHypothesis testingCompare nested models  and  using the difference of theirdeviances.\nConsider:\n\ncorresponding to ; v.s.\ncorresponding to , with .\n\nTest  against  by considering \n\n \n\nIf both models describe the data well then , and .\n\n\n\n\n\n\n\n\nProof\nRecall the Taylor series expansion for the log-likelihoodSince  is the MLE,  and hence this becomesTherefore, the statisticwill be approximately . (底部有证明)\n\n\nModels for binary/binomial response – Logistic 回归The table below shows results of a bioassay to compare the biological potencies of two preparations (batches) of insulin, by measuring the proportions of rodents that exhibit a particular response to different doses of each preparation.\n研究人员进行了一项生物测定实验 (bioassay), 以比较两批胰岛素 (标准批次 vs 试验批次)的生物效能. 实验测量了不同剂量下动物产生反应的比例.\nA different group of rodents is used for each dose of each preparation. It is desired to measure the potency of the test preparation relative tothe standard where, for tip Example, the potency is 2 if the proportion of responses produced by the standard preparation can be obtained using only half the dose of the test preparation.\nPotency may be estimated by using logistic regression analysis, assuming that the rodents exhibit a logistic tolerance distribution in relationship to the . In this analysis,  is used as one explanatory variable and preparation (test or standard) as another. The following is abbreviated output from fitting two models,  and , in R.\n试验批次:\n此时, 使得 \n\n\n\n\n[ 超纲内容] 效力 (Potency)\n\n\n\n\n\n\nExample\nThe ratio of the median effective doses of standard to test preparations is an estimate of the potency. Calculate the potency.\n\n\n\n\n\n\n\n\nSolution\n由题易得, 效力公式为二者中位数之比, 即\n\n\n\n\n意味着标准批次的效力只占试验批次的.\n\n在该实验中, 每个剂量组对应一组新的动物, 避免了交叉干扰. 研究者希望估算试验批次相对于标准批次的效力 (potency). 假设动物对剂量的对数() 呈现 Logistic 反应分布, 进行 Logistic 回归分析, 并通过广义线性模型 (GLM) 估算效力.\n12345678910111213&gt; m1 &lt;- glm(cbind(Resp,NonResp) log10(Dose)*Prep, family=binomial)&gt; summary(m1)Coefficients:Estimate Std. Error z value Pr(&gt;|z|)    (Intercept)   -5.7907   0.6839  -8.467  &lt;2e-16 ***log10(Dose)    5.5180   0.6446   8.561  &lt;2e-16 ***PrepTest      -0.2170   1.2077  -0.180  0.857    log10(Dose):PrepTest -0.6269   1.0464  -0.599  0.549    Null deviance: 166.8335 on 13 degrees of freedomResidual deviance: 8.4351  on 10 degrees of freedomAIC: 64.287\n123456789101112&gt; m0 &lt;- glm(cbind(Resp,NonResp) log10(Dose)+Prep, family=binomial)&gt; summary(m0)Coefficients:Estimate Std. Error z value Pr(&gt;|z|)    (Intercept)   -5.5531   0.5427  -10.23  &lt; 2e-16 ***log10(Dose)    5.2894   0.5057   10.46  &lt; 2e-16 ***PrepTest      -0.9290   0.2334   -3.98  6.89e-05 ***Null deviance: 166.8335 on 13 degrees of freedomResidual deviance: 8.7912  on 11 degrees of freedomAIC: 62.644\n\nLogistic 回归模型\n用于建模二分类数据, 即, 如 成功/失败、存活/死亡等.\n交互项\n\n\n\n\n\nExample\nBased on the above output, does the effect of preparation on the odds of the response depend on the dose? Explain.效应是否依赖于计量?\n\n\n\n\n\n\n\n\nSolution\n观察回归模型  中 交互项  的 p 值 . 这说明交互项不显著, 意味着剂量效应在不同批次间没有显著差异.\n\n模型选择\n观察模型在建模过程中的不同, 选择更简单且更有效的模型 (如: 交互项会提升模型复杂度, 其p值并不占优, 那么放弃这种建模方法);\n观察AIC (Akaike information criterion), 越小越好.\n\n\n\n\n\n\n\n\nSolution\n在两个模型中显然选择, 理由是\n\n交互项  的 p 值 , 这说明交互项不显著, 意味着剂量效应在不同批次间没有显著差异.\n 的  比  的  更低 (说明  更好).\n\n\n\n回归方程根据上述结论选择后, 得到回归方程为:\n估算分位数以中位数为例, 即令, 那么\n标准批次:\n此时, 使得 \n\n\n\n\n胜算比 (Odds Ratio, OR)Definition事件发生的概率与不发生的概率之比被称为胜算 (odd), 即\n\n\n\n\nIn logistic regression we model the log odds:\nThe  coefficients are log odds ratios:\n\n\n\n\n若剂量翻倍, 则翻倍前后的胜算分别为 \n\n \n\n\n因此, 胜算比为 \n\n \n\n\n剂量翻倍, 成功概率约为原来的  倍.\n模型的拟合优度 (Goodness of Fit)残差偏差 (Residual Deviance)\n残差偏差 接近自由度 (Degrees of Freedom, df) 时, 说明模型拟合较好.\n若残差偏差远大于 df, 说明模型拟合不好 (欠拟合) .\n若残差偏差远小于 df, 说明模型可能过拟合 (过度拟合) .\n\n根据 R output 中\n12345&gt; m1 &lt;- glm(cbind(Resp,NonResp) log10(Dose)*Prep, family=binomial)&gt; summary(m1)Residual deviance: 8.4351  on 10 degrees of freedomAIC: 64.287\n12345&gt; m0 &lt;- glm(cbind(Resp,NonResp) log10(Dose)+Prep, family=binomial)&gt; summary(m0)Residual deviance: 8.7912  on 11 degrees of freedomAIC: 62.644\n\n即使看起来m1的 residual deviance 同m0比 更接近 df, 但是代价是牺牲了1个自由度, 即模型更加复杂, 但是 , 这在统计上是微不足道的改进.\n因此m0更优.\nAIC正如中提及到的 的  比  的  更低 (说明  更好).\nObserved Values vs. Fitted Values如表所示, 显然m0的拟合值更接近真实值.\n\n\n\nObserved values\nm1\nm0\n\n\n\n1\n0\n1.79\n\n\n2\n5\n4.39\n\n\n3\n11\n9.30\n\n\n4\n14\n12.59\n\n\n5\n18\n18.44\n\n\n6\n21\n21.76\n\n\n7\n23\n23.46\n\n\n8\n30\n30.28\n\n\n9\n27\n26.99\n\n\nHosmer-Lemeshow 拟合优度检验 (Optional)若 Hosmer-Lemeshow p 值 , 说明模型拟合良好.\nROC (Receiver Operating Characteristic) 曲线 (Optional)ROC曲线下方的面积 (Area under the Curve (AUC) of ROC),\n\n, 是完美分类器, 采用这个预测模型时,存在至少一个阈值能得出完美预测.\n, 优于随机猜测. 这个分类器 (模型) 妥善设置阈值的话, 能有预测价值.\n, 跟随机猜测一样 (例：丢铜板) , 模型没有预测价值.\n, 比随机猜测还差；但只要总是反预测而行, 就优于随机猜测.\n\nModels for count responses – Poisson 回归For the number of occurrences , we assume that  follows the Poisson distribution  with probability mass function given by  The mean and variance of  are both equal to .\n泊松回归中的偏置项 (Offset)Let  be independent random variables with  denoting the number of events occurred from exposure  for the th covariate pattern. ThenThe dependenceon explanatory variables is usually modelled by. Thecorresponding GLM isThis corresponds to the log link:where the term  is called the offset.\n\n泊松回归用于建模计数数据, 但在一些情况下, 数据的观测时间或规模不同, 需要进行标准化.\n偏置项 (Offset) 允许我们调整不同观察单位的规模, 使得模型估计的是标准化的投诉率, 而非原始投诉数量.\n\n比如, 不加偏置项的泊松回归:引入偏置项:其中:\n\n: 第  个医生收到的投诉数.\n: 医生的就诊次数 (offset).\n\n在不同医生就诊次数不均等的情况下, 使得比较投诉数时更公平.\nR Output\nresidency, (), a binary variable taking values  or  corresponding to whether the doctor had completed residency training;\npay, (), giving the dollars per hour earned by the doctor;\nhours, (), giving the total number of hours worked by the doctorthat year.\n\n123456789101112glm(formula = complaints  residency + offset(log(visits)), family = poisson)Coefficients:\t            Estimate\tStd. Error\tz value\tPr(&gt;|z|) (Intercept)\t-6.4525\t\t0.1026\t-62.891\t&lt;2e-16\t*** residencyY\t\t-0.3041\t\t0.1725\t-1.763\t\t0.0779\t.Null deviance: 63.435\ton 43\tdegrees of freedomResidual deviance: 60.245\ton 42\tdegrees of freedomAIC: 187.03Number of Fisher Scoring iterations: 5\n回归方程 表示 完成住院培训的医生的投诉数更少.\n指数变换:  投诉数减少  (即 ) . 完成住院培训的医生的投诉率是未培训医生的 .\n然而 (接近 0.05, 但不够显著) . 说明住院培训可能影响投诉率, 但统计显著性不强.\n最优模型选择如表所示.\n\n\n\nModel\nDeviance\n差值\n解释\n\n\n\nNull\n63.435\n\n\n\n\nH\n57.347\n\n\n\n\nH + P\n57.131\n-0.216\n几乎无改进\n\n\nH + P + R\n55.341\n-1.79\nR 变量有效 (有用)\n\n\nH + P + R + H*P\n53.789\n-1.552\nH 和 P 存在交互作用 (有用)\n\n\nH + P + R + H*R\n50.182\n-3.607\nH 和 R 存在交互作用 (有用)\n\n\nH + P + R + H*P + H*R\n44.747\n-5.435\n最优\n\n\nH + P + R + H*P + H*R + P*R\n44.405\n-0.342\nP 和 R 的交互作用并不显著\n\n\n过度离散 (Overdispersion)泊松回归的一个重要假设是：但如果数据中方差远大于均值, 则称为过度离散 (Overdispersion). 出现这种情况的原因如下:\n\n未包含关键解释变量: 可能有遗漏的影响因素.\n数据有群组效应: 例如, 某些医生整体投诉率较高或较低.\n\n过度离散的表现：\n\n泊松模型的残差偏差（Residual Deviance）远大于自由度.\nAIC 值很高，表明模型拟合不佳.\n\n处理办法:\n\n使用负二项回归 (Negative Binomial Regression):负二项回归增加一个额外的离散参数, 允许方差大于均值:\n调整标准误: 过度离散可能来源于未考虑某些医生特征\n\n考试大纲Part 1 – 指数族分布\n指数族分布的性质推导；\n公式（20）的 score 推导和公式（21）的 information in the general case 推导.可能会要求你获取特定分布、模型和链接函数的得分和信息.\n公式（20）的 score 推导：此前提及过在计算 score statistic 时，使用链式法则，当我们想用 OLS 估计  时，其中因此\n公式（21）的 information in the general case 推导：因为 , 因此当  时一个矩阵时, 则\n\n\n\n\n导数（涉及泰勒级数展开）用于样本分布的得分、最大似然估计和偏差。需要知道分布结果。\nInference.上面提到 , 因此对于 univariate , 有那么, 对于 , 则有\n泰勒级数展开的应用.\n\n\n\n由于, 则For a vector  of parameters this generalises toSimilarly for the score function with a single parameter  the Taylor series expansion isFor a vector  of parameters this generalises to如果  是通过 MLE 估计的, 那么 , 因此The variance-covariance matrix for  is因此\n\n\n关于 hat matrix 的详细信息，标准化残差以及检查异常值 (outliers)/影响点 (influential observations) 的办法.For a normal linear model, the residuals are given by . The variance-covariance matrix of the vector of residuals  is given bywhere  is the identity matrix and  is the \\textbf{hat matrix}.\n\nWe use the standardised residuals\n\n\n\n\nto check the adequacy of the model. Under the model assumptions the standardised residuals are\n\n\n\n\nModel assumption\nDiagnostic plot\n\n\n\n1\nLinearity of relationships between variables\nStandardised residuals against each of the explanatory variables\n\n\n2\nNormality of errors\nNormal probability plot (residuals against their expected\\ values) standardised residuals against the fitted values \n\n\n3\nConstant variance\n同上\n\n\n4\nSerial independence of observations\nSequence plot of the standardised residuals\n\n\nOutliers are observations that are not well fitted by the model.Influential observations have a large effect on inferences based on the model. Influential observations may or may not be outliers and vice versa.The th diagonal element of the hat matrix, , is known as the leverage of the th observation.\nPart 2 – Logistic 回归\n偏差残差公式。\n除了比例风险逻辑回归模型之外，还有序逻辑回归模型。\n\nPart 3 – Logistic 回归拟合零膨胀和门槛模型。足够熟悉它们何时适用。\n\n\n\n","slug":"广义线性模型","date":"2025-05-07T23:00:00.000Z","categories_index":"Notes","tags_index":"Postgraduate","author_index":"王观旭"},{"id":"447543686161755d1d0ef6097e7f563d","title":"Welcome!","content":"Welcome to MyBrain! 欢迎来到我的知识库！如果你能来到这里，就说明你可以在这里找到你想要的资料。\n原来的网页将不再进行更新和维护，只作为文件的储存空间，未来的一切资料都将在这里更新。期待您的评论提出的建议！\n","slug":"Welcome","date":"2025-05-06T23:00:00.000Z","categories_index":"Welcome","tags_index":"Welcome","author_index":"王观旭"},{"id":"5c23f1ec9c24b8ff3e38cf8690d48a6e","title":"Notes of Master","content":"24fall MSc in Statistics, University of GlasgowSemester 1\nSTATS5103 Introduction to Statistical Programming in R and Python: (Being built…);\nSTATS5015 Biostatistics: 手写笔记, 电子笔记, Past Paper 汇总 (手写笔记);\nSTATS5024 Probability: 本科笔记 (手写);\nSTAT5025 Regression Models: 电子笔记;\nSTAT5028 Statistical Inference: 手写笔记, 电子笔记.\n\nSemester 2\nSTATS5012 Spatial Statistics (Optional courses): 电子笔记;\nSTATS5014 Bayesian Statistics: 电子笔记;\nSTATS5030 Time Series (Optional courses): 手写笔记 (本科), 电子笔记;\nSTATS5085 Data Analysis Skills: Poster LaTeX 模板（点击直接下载）, Glasgow Beamer 模版（点击直接下载）;\nSTATS5099 Data Mining and Machine Learning: 电子笔记;\nSTATS5019 Generalised Linear Models: 电子笔记.\n\n","slug":"Postgraduate","date":"2024-08-31T23:00:00.000Z","categories_index":"Files","tags_index":"Postgraduate","author_index":"王观旭"},{"id":"e7986d5fc72c3a33d3bb6e8786fed7c0","title":"Textbook of Senior High School","content":"Textbook of Senior High School本人独立编写的高中数学教材《数学·那可太好玩了》。\n\n","slug":"SeniorHighSchool","date":"2023-08-31T23:00:00.000Z","categories_index":"Files","tags_index":"Senior","author_index":"王观旭"},{"id":"96394079a6bfdd06f23cf5b0c39d5fdb","title":"Notes of Bachelor","content":"BSc in Mathematics and Applied Mathematics and BEc in Finance, Shenzhen University第一学年（2019-2020）第1学期\n数学分析（1）；\n解析几何；\n微观经济学（英文版）；\n政治经济学。\n\n第2学期\n数学分析（2）：手写笔记；\n高等代数；\n宏观经济学（英文版）；\n基础会计学。\n\n第二学年（2020-2021）第3学期\n常微分方程：手写笔记；\n数据结构与算法；\n概率论与数理统计：手写笔记；\nPython编程；\n运筹学：手写笔记；\n金融学。\n\n第4学期\n数据库原理与应用；\n非寿险精算学；\nMATLAB编程；\n数学建模；\n公司理财（英文版）；\n金融统计学；\n证券投资学；\n商业银行经营与管理；\n投资与投资决策分析。\n\n第三学年（2021-2022）第5学期\n数值分析：手写笔记；\n随机过程：手写笔记；\n寿险精算学：手写笔记；\n时间序列分析：手写笔记；\n财政学：电子笔记；\n国际金融（英文版）；\n金融衍生品；\n金融计量分析；\n财务报表分析与证券估值（英文版）：电子笔记。\n\n第6学期\n偏微分方程：手写笔记；\n风险管理原理；\n国际结算（英文版）：电子笔记。\n\n第四学年（2022-2023）第7学期\n金融数学：手写笔记；\n精算学导论：手写笔记；\n金融工程：内容同金融数学；\n固定收益证券。\n\n第8学期\n毕业论文&#x2F;设计（数学与应用数学-理学学士）：《风险模型中破产变量的近似解研究》【摘要】 本文在经典复合Poisson风险模型的Seal型偏积分微分方程组的求解问题的基础上，研究了费率不同的马尔可夫调节风险模型（MMRM）的有限时间生存概率的计算问题。结合了由数据驱动的深度神经网络（DNN）方法和牛顿-柯特斯公式的方法先对连续函数进行离散，从而通过DNN来计算有限时间生存概率。给出了在服从指数分布、Gamma分布和Pareto分布的索赔分布下的两状态MMRM数值逼近结果；以及在服从指数分布Pareto分布的索赔分布下的七状态MMRM数值逼近结果。将该方法和马尔可夫链蒙特卡罗模拟方法进行对比，结果表明，该方法在不同索赔分布下都能得到准确的结果。\n毕业论文&#x2F;设计（金融学-经济学学士）：《基于神经网络对标普500指数预测研究》【摘要】 本文旨在探究使用长短期记忆网络模型（LSTM）对标普500指数进行预测的效果，并与传统的自回归移动平均模型（ARIMA）进行对比。使用历史的标普500指数数据作为训练集和测试集，分别构建了LSTM模型和ARIMA模型，并通过实验对比两种模型的预测效果。通过对比LSTM模型和ARIMA模型在时间序列预测方面的性能，发现LSTM模型在预测准确率和稳定性方面均优于ARIMA模型。此外发现LSTM模型能够有效地处理时间序列数据中的长期依赖关系，并且自动地提取时间序列数据的特征。这些特性使得LSTM模型成为时间序列分析领域中的热门模型之一。研究结果表明，LSTM模型在预测金融时间序列数据方面具有很强的应用潜力，可以作为一种有效的预测模型来指导投资决策。同时还为金融领域的时间序列预测提供了新的思路和方法。\n\n","slug":"Undergraduate","date":"2019-08-31T23:00:00.000Z","categories_index":"Files","tags_index":"Undergraduate","author_index":"王观旭"}]